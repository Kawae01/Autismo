<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Cobrinha Jogo</title>
<style>
body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  height: 100%;
  touch-action: none;
  display: flex;
  justify-content: center;
  align-items: center;
  font-family: 'Courier New', monospace;
  background: linear-gradient(to bottom, #1a3d1a, #0e220e);
}

canvas {
  border: 10px solid #0d260d;
  background: #1e5f1e;
  display: block;
}

#menu {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: #133913;
  padding: 20px;
  border-radius: 15px;
  text-align: center;
  z-index: 10;
  color: white;
}

#menu input, #menu select, #menu button {
  margin: 8px 0;
  padding: 10px;
  font-size: 16px;
  border-radius: 10px;
  border: none;
}

#score {
  position: absolute;
  top: 10px;
  left: 20px;
  color: white;
  font-size: 20px;
}
</style>
</head>
<body>

<div id="menu">
  <h1>üêç Cobrinha Jogo</h1>
  <input type="text" id="playerName" placeholder="Digite seu nome"><br>

  <label>Cor da Cobra:</label><br>
  <select id="snakeColor">
    <option value="yellow">Amarelo</option>
    <option value="cyan">Ciano</option>
    <option value="lime">Verde Lim√£o</option>
    <option value="orange">Laranja</option>
    <option value="pink">Rosa</option>
  </select><br>

  <label>Modo de Jogo:</label><br>
  <select id="gameMode">
    <option value="classico">Cl√°ssico</option>
    <option value="infinito">Infinito</option>
    <option value="hardcore">Hardcore</option>
  </select><br>

  <button onclick="startGame()">Iniciar</button>
</div>

<div id="score"></div>
<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const box = 20;

let snake, food, obstacles = [];
let score = 0;
let d = null;
let game;
let playerName, snakeColor, mode;
let paused = false;

// Ajusta canvas
function resizeCanvas(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

// IN√çCIO DO JOGO
function startGame(){
  document.getElementById("menu").style.display = "none";

  playerName = document.getElementById("playerName").value || "Jogador";
  snakeColor = document.getElementById("snakeColor").value;
  mode = document.getElementById("gameMode").value;

  snake = [{x: 10*box, y: 10*box}];
  score = 0;
  d = "RIGHT";
  obstacles = [];

  generateFood();
  if(mode==="hardcore") generateObstacles();

  clearInterval(game);
  game = setInterval(draw, mode==="hardcore"?80:100);
}

// GERA COMIDA
function generateFood(){
  food = {
    x: Math.floor(Math.random()*(canvas.width/box))*box,
    y: Math.floor(Math.random()*(canvas.height/box))*box
  };
}

// OBST√ÅCULOS
function generateObstacles(){
  for(let i=0;i<10;i++){
    obstacles.push({
      x: Math.floor(Math.random()*(canvas.width/box))*box,
      y: Math.floor(Math.random()*(canvas.height/box))*box
    });
  }
}

// TECLADO
document.addEventListener("keydown", e=>{
  if(e.key=="ArrowLeft" && d!="RIGHT") d="LEFT";
  else if(e.key=="ArrowUp" && d!="DOWN") d="UP";
  else if(e.key=="ArrowRight" && d!="LEFT") d="RIGHT";
  else if(e.key=="ArrowDown" && d!="UP") d="DOWN";
  else if(e.key=="p") paused=!paused;
  else if(e.key=="r") restartGame();
});

// SWIPE
let startX, startY;
canvas.addEventListener("touchstart", e=>{
  startX=e.touches[0].clientX;
  startY=e.touches[0].clientY;
},{passive:true});

canvas.addEventListener("touchend", e=>{
  let dx = e.changedTouches[0].clientX - startX;
  let dy = e.changedTouches[0].clientY - startY;
  if(Math.abs(dx)>Math.abs(dy)){
    if(dx>0 && d!="LEFT") d="RIGHT";
    else if(dx<0 && d!="RIGHT") d="LEFT";
  } else {
    if(dy>0 && d!="UP") d="DOWN";
    else if(dy<0 && d!="DOWN") d="UP";
  }
},{passive:true});

// DESENHO DO JOGO
function draw(){
  if(paused) return;

  ctx.fillStyle="#1e5f1e";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // Cobra
  for(let i=0;i<snake.length;i++){
    ctx.fillStyle = i==0 ? "white" : snakeColor;
    ctx.fillRect(snake[i].x, snake[i].y, box, box);
  }

  // Comida (ma√ß√£)
  ctx.fillStyle="red";
  ctx.beginPath();
  ctx.arc(food.x+box/2, food.y+box/2, box/2, 0, Math.PI*2);
  ctx.fill();

  // Obst√°culos
  ctx.fillStyle="gray";
  obstacles.forEach(o=>ctx.fillRect(o.x,o.y,box,box));

  // Movimento
  let snakeX = snake[0].x;
  let snakeY = snake[0].y;

  if(d=="LEFT") snakeX -= box;
  if(d=="UP") snakeY -= box;
  if(d=="RIGHT") snakeX += box;
  if(d=="DOWN") snakeY += box;

  // Modo infinito
  if(mode==="infinito"){
    if(snakeX < 0) snakeX = canvas.width - box;
    if(snakeY < 0) snakeY = canvas.height - box;
    if(snakeX >= canvas.width) snakeX = 0;
    if(snakeY >= canvas.height) snakeY = 0;
  }

  // Come comida
  if(snakeX === food.x && snakeY === food.y){
    score++;
    generateFood();
  } else {
    snake.pop();
  }

  let newHead = {x: snakeX, y: snakeY};

  // Colis√µes parede
  if(mode!=="infinito"){
    if(snakeX<0||snakeY<0||snakeX>=canvas.width||snakeY>=canvas.height) return gameOver();
  }

  // Colis√£o corpo
  if(collision(newHead,snake)) return gameOver();

  // Colis√£o obst√°culos
  for(let o of obstacles){
    if(newHead.x===o.x && newHead.y===o.y) return gameOver();
  }

  snake.unshift(newHead);

  document.getElementById("score").innerText = playerName + " | Pontos: " + score;
}

function collision(head,array){
  return array.some(segment=>segment.x===head.x && segment.y===head.y);
}

function gameOver(){
  clearInterval(game);
  alert("üíÄ Game Over, "+playerName+"! Pontos: "+score);
  document.getElementByById("menu").style.display="block";
}

function restartGame(){
  clearInterval(game);
  startGame();
}
</script>
</body>
</html>
