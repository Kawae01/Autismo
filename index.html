<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>üêç Cobrinha Jogo</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden; /* Bloqueia scroll no mobile */
  height: 100%;
  touch-action: none; /* Bloqueia gestos de zoom e scroll */
}
body {
  display: flex;
  justify-content: center;
  align-items: center;
  font-family: 'Courier New', monospace;
  background: linear-gradient(to bottom, #1a3d1a, #0e220e);
}

canvas {
  border: 10px solid #0d260d;
  background: #1e5f1e;
  display: block;
}

#menu {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(0,0,0,0.85);
  padding: 30px;
  border-radius: 20px;
  color: white;
  text-align: center;
  z-index: 10;
}

#menu input, #menu select, #menu button {
  margin: 8px 0;
  padding: 10px;
  font-size: 16px;
  border-radius: 10px;
  border: none;
}

#score {
  position: absolute;
  top: 10px;
  left: 10px;
  color: white;
  font-size: 22px;
  font-weight: bold;
  text-shadow: 2px 2px 4px #000;
  z-index: 5;
}
</style>
</head>
<body>

<div id="menu">
  <h1>üêç Cobrinha Jogo</h1>
  <input type="text" id="playerName" placeholder="Digite seu nome"><br>

  <label>Cor da Cobra: </label>
  <select id="snakeColor">
    <option value="yellow">Amarelo</option>
    <option value="blue">Azul</option>
    <option value="purple">Roxo</option>
    <option value="orange">Laranja</option>
    <option value="pink">Rosa</option>
    <option value="rainbow">Rainbow</option>
  </select><br>

  <label>Modo de Jogo: </label>
  <select id="gameMode">
    <option value="classico">Cl√°ssico</option>
    <option value="infinito">Infinito</option>
    <option value="hardcore">Hardcore</option>
  </select><br>
  <script>
  const select = document.getElementById("snakeColor");

  function updateColor() {
    let color = select.value;

    if (color === "rainbow") {
      // deixa o select com efeito arco-√≠ris
      select.style.background = "linear-gradient(90deg, red, orange, yellow, green, blue, indigo, violet)";
      select.style.color = "white";
    } else {
      // cores normais
      select.style.background = color;
      select.style.color = (color === "yellow" || color === "pink" || color === "orange")
        ? "black"
        : "white";
    }
  }

  select.addEventListener("change", updateColor);
  updateColor();
</script>

  <button onclick="startGame()">Iniciar</button>
</div>

<div id="score"></div>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const menu = document.getElementById("menu");
const scoreDisplay = document.getElementById("score");

let box = 20;
let snake = [];
let food;
let obstacles = [];
let score = 0;
let d;
let game;
let playerName;
let snakeColor;
let mode;
let particles = [];
let paused = false;

function resizeCanvas(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

// IN√çCIO DO JOGO
function startGame(){
  playerName = document.getElementById("playerName").value || "Jogador";
  snakeColor = document.getElementById("snakeColor").value || "green";
  mode = document.getElementById("gameMode").value;
  menu.style.display = "none";

  snake = [{x:10*box, y:10*box}];
  score = 0;
  d = null;
  obstacles = [];
  particles = [];

  generateFood();
  if(mode==="hardcore") generateObstacles();

  if(game) clearInterval(game);
  game = setInterval(draw, mode==="hardcore"?80:100);
}

// GERA COMIDA SEM COLIDIR COM COBRA OU OBST√ÅCULOS
function generateFood(){
  let valid = false;
  while(!valid){
    food = {
      x: Math.floor(Math.random()*(canvas.width/box))*box,
      y: Math.floor(Math.random()*(canvas.height/box))*box
    };
    valid = !collision(food, snake) && !collision(food, obstacles);
  }
}

// GERA OBST√ÅCULOS HARDCORE
function generateObstacles(){
  obstacles=[];
  for(let i=0;i<10;i++){
    let valid=false;
    while(!valid){
      let o = {
        x: Math.floor(Math.random()*(canvas.width/box))*box,
        y: Math.floor(Math.random()*(canvas.height/box))*box
      };
      valid = !collision(o, snake) && !collision(o, obstacles);
      if(valid) obstacles.push(o);
    }
  }
}

// EVENTOS TECLADO
document.addEventListener("keydown", e=>{
  if(e.key=="ArrowLeft" && d!="RIGHT") d="LEFT";
  else if(e.key=="ArrowUp" && d!="DOWN") d="UP";
  else if(e.key=="ArrowRight" && d!="LEFT") d="RIGHT";
  else if(e.key=="ArrowDown" && d!="UP") d="DOWN";
  else if(e.key=="p") paused=!paused;
  else if(e.key=="r") restartGame();
});

// EVENTOS TOUCH (SWIPE)
let startX, startY;
canvas.addEventListener("touchstart", e=>{
  e.preventDefault();
  startX=e.touches[0].clientX;
  startY=e.touches[0].clientY;
},{passive:false});

canvas.addEventListener("touchmove", e=>{
  e.preventDefault();
},{passive:false});

canvas.addEventListener("touchend", e=>{
  e.preventDefault();
  let dx = e.changedTouches[0].clientX - startX;
  let dy = e.changedTouches[0].clientY - startY;
  if(Math.abs(dx)>Math.abs(dy)){
    if(dx>0 && d!="LEFT") d="RIGHT";
    else if(dx<0 && d!="RIGHT") d="LEFT";
  } else {
    if(dy>0 && d!="UP") d="DOWN";
    else if(dy<0 && d!="DOWN") d="UP";
  }
},{passive:false});

// PAUSA E RESTART
function restartGame(){
  clearInterval(game);
  menu.style.display="block";
}

// COLIS√ÉO
function collision(head,array){
  for(let i=0;i<array.length;i++){
    if(head.x==array[i].x && head.y==array[i].y) return true;
  }
  return false;
}

// PARTICULAS
function createParticles(x,y){
  for(let i=0;i<10;i++){
    particles.push({
      x:x+box/2,
      y:y+box/2,
      vx:(Math.random()-0.5)*2,
      vy:(Math.random()-0.5)*2,
      alpha:1
    });
  }
}

function drawParticles(){
  for(let i=particles.length-1;i>=0;i--){
    let p=particles[i];
    ctx.fillStyle=`rgba(255,255,0,${p.alpha})`;
    ctx.beginPath();
    ctx.arc(p.x,p.y,2,0,Math.PI*2);
    ctx.fill();
    p.x+=p.vx*5;
    p.y+=p.vy*5;
    p.alpha-=0.05;
    if(p.alpha<=0) particles.splice(i,1);
  }
}

// LOOP PRINCIPAL
function draw(){
  if(paused) return;

  // FUNDO QUADRICULADO
  for(let x=0;x<canvas.width;x+=box){
    for(let y=0;y<canvas.height;y+=box){
      ctx.fillStyle=((x/box + y/box)%2==0)?"#267326":"#2e8b2e";
      ctx.fillRect(x,y,box,box);
    }
  }

  // OBST√ÅCULOS
  if(mode==="hardcore"){
    ctx.fillStyle="brown";
    obstacles.forEach(o=>ctx.fillRect(o.x,o.y,box,box));
  }

  // COBRA SLITHER.IO
  ctx.lineWidth=box;
  ctx.lineCap='round';
  ctx.strokeStyle=snakeColor;
  if(snake.length>1){
    ctx.beginPath();
    ctx.moveTo(snake[0].x+box/2, snake[0].y+box/2);
    for(let i=1;i<snake.length;i++){
      ctx.lineTo(snake[i].x+box/2, snake[i].y+box/2);
    }
    ctx.stroke();
  } else {
    ctx.fillStyle=snakeColor;
    ctx.beginPath();
    ctx.arc(snake[0].x+box/2,snake[0].y+box/2,box/2,0,Math.PI*2);
    ctx.fill();
  }

  // COMIDA MA√á√É
  let fx = food.x + box/2;
  let fy = food.y + box/2;
  ctx.fillStyle="red";
  ctx.beginPath();
  ctx.arc(fx,fy,box/2,0,Math.PI*2);
  ctx.fill();
  // folha
  ctx.fillStyle="green";
  ctx.beginPath();
  ctx.moveTo(fx, fy - box/2);
  ctx.lineTo(fx - box/6, fy - box*0.7);
  ctx.lineTo(fx + box/6, fy - box*0.7);
  ctx.closePath();
  ctx.fill();
  // cabinho
  ctx.strokeStyle="#8B4513";
  ctx.lineWidth=2;
  ctx.beginPath();
  ctx.moveTo(fx, fy - box/2);
  ctx.lineTo(fx, fy - box*0.8);
  ctx.stroke();

  drawParticles();

  // POSI√á√ÉO NOVA
  let snakeX=snake[0].x;
  let snakeY=snake[0].y;
  if(d=="LEFT") snakeX-=box;
  if(d=="UP") snakeY-=box;
  if(d=="RIGHT") snakeX+=box;
  if(d=="DOWN") snakeY+=box;

  // MODO INFINITO
  if(mode==="infinito"){
    if(snakeX<0) snakeX=canvas.width-box;
    if(snakeY<0) snakeY=canvas.height-box;
    if(snakeX>=canvas.width) snakeX=0;
    if(snakeY>=canvas.height) snakeY=0;
  }

  // COMER COMIDA
  if(snakeX==food.x && snakeY==food.y){
    score++;
    createParticles(food.x,food.y);
    generateFood();
  } else {
    snake.pop();
  }

  let newHead={x:snakeX,y:snakeY};

  // COLIS√ïES
  if(mode!=="infinito"){
    if(snakeX<0||snakeY<0||snakeX>=canvas.width||snakeY>=canvas.height) return gameOver();
  }
  if(collision(newHead,snake)) return gameOver();
  if(mode==="hardcore" && collision(newHead,obstacles)) return gameOver();

  snake.unshift(newHead);

  // PLACAR
  scoreDisplay.innerText=`${playerName} | Modo: ${mode} | Score: ${score}`;
}

// GAME OVER
function gameOver(){
  clearInterval(game);
  alert(`üíÄ Game Over, ${playerName}! Pontua√ß√£o: ${score}`);
  menu.style.display="block";
}
</script>
</body>
</html>
